<div class='AboutRaceImageContainer'>
  <img 
    *ngIf="this.aboutData != null && this.aboutData.race_image != null" 
    src="{{aboutData.race_image}}" 
    alt="race_img"
    class='AboutRaceImage'
  />
</div>

<!--<div class='PageContainer' *ngIf="this.aboutData != null; else LoadingRaceBlock">-->
<div class="PageContainer">
  <div class='PageSegment'>
    <a class="nav-link" routerLink='/races'><- Return to Public Races</a>
    <ng-template [ngIf]="this.aboutData == null" [ngIfElse]="RaceHeaderBlock">
      <p>Loading race description and dates...</p>
    </ng-template>
    <ng-template #RaceHeaderBlock>
      <div class='RaceHeader'>
        <h1>{{aboutData.name}}</h1>
        <div class='CalendarDaysContainer'>
          <div class='CalendarDay'>
            <div class='CalendarDayM'><p class='h7'>{{aboutData.start_date.month}}</p></div>
            <div class='CalendarDayD'><p>{{aboutData.start_date.day}}</p></div>
          </div>
          <div class='CalendarDaysLine'>
            <p class='h7'>to</p>
          </div>
          <div class='CalendarDay'>
            <div class='CalendarDayM'><p class='h7'>{{aboutData.end_date.month}}</p></div>
            <div class='CalendarDayD'><p>{{aboutData.end_date.day}}</p></div>
          </div>
        </div>
      </div>
      <p>{{aboutData.description}}</p>
      <!-- icon to indicate race type : 1-run;2-bike;3-all -->
      <!--<i *ngIf="aboutData.race_type == 3" class="material-icons">directions_run</i> <i class="material-icons" >directions_bike</i>--> 
      <i *ngIf="aboutData.race_type == 1" class="material-icons">directions_run</i>
      <i *ngIf="aboutData.race_type == 2" class="material-icons">directions_bike</i> 
    </ng-template>
  </div>
    
  <div class='PageSegment'>
    <h3>Race Details</h3>

    <div class='Slideshow'>
      <div class="SlideshowHeader">
        <button class="SlideshowButton" (click)="SwitchSlideshow('map')">Route Map</button>
        <!--<button class="SlideshowButton" (click)="SwitchSlideshow('info')">Information</button>-->
        <button class="SlideshowButton" (click)="SwitchSlideshow('logistics')">Logistics</button>
      </div>
      <div class="SlideshowContents">
        <div class="SlideshowSlide" [ngClass]="{'Slideshow-CurrentSlide' : currentScreen == 'map'}">
          <div class='MapContainer'>
            <app-map [raceIDs]="raceID" [displayUsers]="false" zoom="true"></app-map>
          </div>
        </div>
        <!--
        <div class="SlideshowSlide" [ngClass]="{'Slideshow-CurrentSlide' : currentScreen == 'info'}">
          <ng-template [ngIf]="this.aboutData == null">
            <p>Loading race details...</p>
          </ng-template>
          <h6>Race Type</h6>
          <button (click)="this.openModal('custom-modal-4')">What does this mean?</button>
          <p *ngIf="this.aboutData.is_hybrid; else VirtualText">Hybrid </p>
          <ng-template #VirtualText>
            <p>Virtual</p>
          </ng-template>
          <h6>Entry Fee</h6>
          <p *ngIf="this.raceSettings != null; else LoadingRaceSettings">${{raceSettings.price}}</p>
          <ng-template #LoadingRaceSettings>
            <p>Loading Race Settings</p>
          </ng-template>
        </div>
        -->
        <div class="SlideshowSlide" [ngClass]="{'Slideshow-CurrentSlide' : currentScreen == 'logistics'}">
          <ng-template [ngIf]="this.aboutData == null" [ngIfElse]="RaceLogisticsBlock">
            <p>Loading race details...</p>
          </ng-template>
          <ng-template #RaceLogisticsBlock>
            <div class='RaceLocationsContainer'>
              <p class='RaceLocation'>{{aboutData.start_loc}}</p>
              <div class='RaceDistanceLine'>
                <p class='h7'>{{aboutData.distance}}km</p>
              </div>
              <p class='RaceLocation'>{{aboutData.end_loc}}</p>
            </div>
          </ng-template>
          <p>
            <span class='h6'>Number of trails: </span>
            <span *ngIf="aboutData.num_children>1;else OneChildBlock">{{aboutData.num_children}}</span>
            <ng-template #OneChildBlock><span>1</span></ng-template>
          </p>
          <p>
            <span class='h6'>Race Type: </span>
            <span *ngIf="this.aboutData.is_hybrid; else VirtualText">Hybrid</span>
            <ng-template #VirtualText><span>Virtual</span></ng-template>
          </p>
          <button (click)="this.openModal('custom-modal-4')">What does this mean?</button>
          <h6>Entry Fee</h6>
          <p *ngIf="this.raceSettings != null; else LoadingRaceSettings">${{raceSettings.price}}</p>
          <ng-template #LoadingRaceSettings>
            <p>Loading Race Settings</p>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
    
  <div class='PageSegment'>
    <h3>Action Items</h3>

    <ng-template [ngIf]="this.aboutData == null" [ngIfElse]="RaceActionsBlock">
      <p>Waiting for race data...</p>
    </ng-template>
    <ng-template #RaceActionsBlock>
      <div class='RaceButtonsContainer'>
        <a class="btn"  (click)="this.viewRace()" *ngIf="this.hasStarted && this.hasJoined">Go to Race</a>
        <a class="btn"  (click)="this.viewRace()" *ngIf="this.hasStarted && !this.hasJoined ">Preview Race</a>
        <a class="btn"  mat-button (click)="this.goToRaceDashboard()" *ngIf="this.isOwner || this.isModerator">GO TO DASHBOARD</a>      
  
        <button *ngIf="!this._authService.isLoggedIn() &&!this.hasJoined" (click)="openModal('custom-modal-2')">Register for Race</button>
        <button *ngIf="this._authService.isLoggedIn() &&!this.hasJoined" (click)="openModal('custom-modal-3')">Register for Race</button>

        <b *ngIf="this._authService.isLoggedIn() && this.hasJoined">You've registered for this race.</b><b *ngIf=" !hasStarted"> Come back on race day ({{aboutData.start_date}}).</b>
      </div>

      <!-- test this by going into the "swag" module in the backend and adding swag to your race -->
    <!-- <app-swag *ngIf="hasMerch" [isOwner]="isOwner" [race_id]="raceID"></app-swag> -->
    </ng-template>
  </div>
</div>

<!--
<ng-template #LoadingRaceBlock>
  <div class="PageContainer">
    <div class='PageSegment'>
      <a class="nav-link" routerLink='/races'><- Return to Public Races</a>
      <h6>Loading Race Data...</h6>
    </div>
  </div>
</ng-template>
-->










<!--
<div class="row">
  <div class="column-about1">
   <div class="container" style="text-align: left;" id="raceView">

     <mat-card class="example-card" style="min-height:650px;" >
       <mat-card-header>
         <i class="material-icons" style="color:#2C00A5;" type="button" routerLink='/races'>keyboard_backspace</i>


            <div *ngIf="aboutData.race_type == 1">
              <i class="material-icons" style="color:#BC164D;">directions_run</i> 
            </div>
            <div *ngIf="aboutData.race_type == 2">
              <i class="material-icons" style="color:#BC164D;">directions_bike</i> 
            </div>
            <div *ngIf="aboutData.race_type == 3">
              <i class="material-icons" style="color:#BC164D;">directions_run</i> <i class="material-icons" style="color:#BC164D;">directions_bike</i> 
            </div>

               <mat-card-title>{{aboutData.name}}
               <i class="material-icons" style="color:#BC164D;">directions_run</i>            
<<<<<<< HEAD
               <app-signup *ngIf="!hasJoined" [price]="raceSettings.price" [hasTags]="raceSettings.has_entry_tags" [aboutData]="aboutData" [race_id]="raceID" [hasStarted]="hasStarted" (signupCallback)="signupCallback($event)" [hasPaid]="hasPaid" (click)="trySignup()"></app-signup>
             </mat-card-title>

=======
               <app-signup *ngIf="!hasJoined" [price]="raceSettings.price" [hasTags]="raceSettings.has_entry_tags" style="color:white;
                box-shadow: 0 5px 15px rgba(145, 92, 182, .4);
                background: green;
                border-radius: 4px;
                font-weight: normal;
                text-transform: uppercase;
                transition: all 0.2s ease-in-out;
                width:90px;height:60px;" [aboutData]="aboutData" [race_id]="raceID" [hasStarted]="hasStarted" (signupCallback)="signupCallback($event)" (click)="trySignup()"></app-signup>
             </mat-card-title>

             </div>
             <div *ngIf="aboutData.race_type == 2">
               <mat-card-title>{{aboutData.name}}
                   <i class="material-icons" style="color:#BC164D;">directions_bike</i>
                   <app-signup *ngIf="!hasJoined" [price]="raceSettings.price" [hasTags]="raceSettings.has_entry_tags" style="color:white;
                box-shadow: 0 5px 15px rgba(145, 92, 182, .4);
                background: green;
                border-radius: 4px;
                font-weight: normal;
                text-transform: uppercase;
                transition: all 0.2s ease-in-out;
                width:90px;height:60px;" [aboutData]="aboutData" [race_id]="raceID" [hasStarted]="hasStarted" (signupCallback)="signupCallback($event)" (click)="trySignup()"></app-signup>
                 </mat-card-title>

           </div>
           <div *ngIf="aboutData.race_type == 3">
               <mat-card-title>{{aboutData.name}}
               <i class="material-icons" style="color:#BC164D;">directions_run</i><i class="material-icons" style="color:#BC164D;">directions_bike</i>
               <app-signup *ngIf="!hasJoined" [price]="raceSettings.price" [hasTags]="raceSettings.has_entry_tags" style="color:white;
                box-shadow: 0 5px 15px rgba(145, 92, 182, .4);
                background: green;
                border-radius: 4px;
                font-weight: normal;
                text-transform: uppercase;
                transition: all 0.2s ease-in-out;
                width:90px;height:60px;" [aboutData]="aboutData" [race_id]="raceID" [hasStarted]="hasStarted" (signupCallback)="signupCallback($event)" (click)="trySignup()"></app-signup>
             </mat-card-title>
           </div>
>>>>>>> 636599b85964d7a48e64f974c7f4419df315ff87



       </mat-card-header>
       <mat-card-content>
         <i class="material-icons" style="color:#BC164D">map</i><span id="txt1">From <b>{{ aboutData.start_loc }}</b> to <b>{{aboutData.end_loc}}</b> <i style="color:#BC164D;">   {{ aboutData.distance }} {{ aboutData.distance_type }}</i></span>
        <i class="material-icons" style="color:#BC164D;">date_range</i><span id="txt1">     From <b>{{ aboutData.start_date }}</b> to <b>{{ aboutData.end_date }}</b></span> 

        <i style="font-size:10px; color:#BC164D;"> Need help? Email admin@tucan.fitness </i>

        <div class="row">
          <div class="column-map">

            <mat-card class="example-card" style="border-top-right-radius:0px;border-bottom-right-radius:0px;" >
       <mat-card-header>
        
       </mat-card-header>
       <mat-card-content>
         <app-map [raceIDs]="raceIDs" [displayUsers]="true"></app-map>
         <br><br> <br><br> <br><br><br><br> <br><br> <br><br><br><br> <br><br> <br><br><br><br> <br><br> <br><br>
       </mat-card-content>
     </mat-card>


          </div>

          <div class="column-map">

            <mat-card class="example-card" >
       <mat-card-header>
       
       </mat-card-header>
       <mat-card-content>
        <div style="max-height: 480px;overflow: auto; border-top-left-radius:0px;border-bottom-left-radius:0px;">
         <h4 style="text-align:center;"><b>Live Leaderboard</b></h4>
         <app-leaderboard [raceID]="raceID" [use]="'individual'" [allowFollow]="true"></app-leaderboard>
         
       </div>
       </mat-card-content>
     </mat-card>
    </div>
    </div>
        
    </mat-card-content>
      <mat-card-actions>
    
        <button mat-button (click)="viewRace()" *ngIf="hasStarted">GO TO RACE</button>
        <button mat-button (click)="goToRaceDashboard()" *ngIf="isOwner || isModerator">GO TO DASHBOARD</button>
      </mat-card-actions>
    </mat-card>

     <br>
   </div>
 </div>

 <div class="column-about">

   <div class="container" *ngIf="!showForm">
       <mat-card class="example-card " style="min-height:650px;">
     <mat-card-header>
       <mat-card-title>About Race</mat-card-title>
     

     </mat-card-header>
     <mat-card-content >
       <img src="{{aboutData.race_image}}" alt="race_img" style="width:80%;" class="center">
      <div style="overflow-y: scroll;height: 190px;background-color:#EFFAF7;">
      {{aboutData.description}} 


</div>


<div class="row" *ngIf="hasMerch">
    <app-swag  [isOwner]="isOwner" [race_id]="raceID"></app-swag>
</div>
    

     </mat-card-content>
     <mat-card-actions>
       <button mat-button (click)="toggleForm()" *ngIf="isOwner">EDIT</button>
     </mat-card-actions>
   </mat-card>
   </div>

  
   <div class="container" *ngIf="showForm">
 <form [formGroup]="AboutForm">
   <div class="form-group" style="text-align: left; padding: 5px;">
     <label name="Name">Name</label>
     <input class="form-control" type="text" placeholder="Name" formControlName="name"/>
     <br>
     <div *ngIf="AboutForm.get('name').invalid && (AboutForm.get('name').dirty || AboutForm.get('name').touched)"
   class="alert alert-danger">
   
   <div *ngIf="AboutForm.get('name').errors.required">
      Name is required.
   </div>
   </div>
   </div>

   <div class="form-group" style="text-align: left; padding: 5px;">
     <label name="description">Description</label>
     <textarea class="form-control" type="text" placeholder="Description" formControlName="description"></textarea>
     <br>
     <div *ngIf="AboutForm.get('description').invalid && (AboutForm.get('description').dirty || AboutForm.get('description').touched)"
   class="alert alert-danger">
   
   <div *ngIf="AboutForm.get('description').errors.required">
      Description is required.
   </div>
   </div>
   </div>

   <div class="form-group" style="text-align: left; padding: 5px;">
     <label name="raceImage">Race Image</label>
     <input type="file" formControlName="raceImage" (change)="onSelectFile($event)"/>
   </div>

   <div formGroupName="rules"> 
     <div class="form-group">
       <mat-slide-toggle formControlName="isManual">Allow Manual Entry</mat-slide-toggle>
     </div>
     <div class="form-group">
       <mat-slide-toggle formControlName="allowTeams">Allow Teams</mat-slide-toggle>
     </div>

     <div class="form-group" style="text-align: left; padding: 5px;" *ngIf="AboutForm.get('rules').get('allowTeams').value == true">
       <label>Max Team Size</label>
       <input class="form-control" type="text" formControlName="maxTeamSize" [matAutocomplete]="maxTeamSizeAuto"/>
 
       <mat-autocomplete #maxTeamSizeAuto="matAutocomplete">
         <mat-option *ngFor="let option of teamSizeOptions" [value]="option">
           {{ option }}
         </mat-option>
       </mat-autocomplete>
 
       <div *ngIf="AboutForm.get('rules').get('maxTeamSize').invalid && (AboutForm.get('rules').get('maxTeamSize').dirty || AboutForm.get('rules').get('maxTeamSize').touched)"
     class="alert alert-danger">
     
     <div *ngIf="AboutForm.get('rules').get('maxTeamSize').errors.max">
        Max Team Size is 10
     </div>
     </div>
     </div>

     <div class="form-group">
      <mat-slide-toggle formControlName="paymentRequired">Require Entry Fee</mat-slide-toggle>
    </div>

    <div class="form-group">
      <mat-slide-toggle formControlName="hasSwag">Add Merchandise Widget</mat-slide-toggle>
    </div>

    <div class="form-group" style="text-align: left; padding: 5px;" *ngIf="AboutForm.get('rules').get('paymentRequired').value == true">
      <label>Entry Fee</label>
      <input class="form-control" type="text" formControlName="price"/>

   </div>

   <div class="form-group">
    <mat-slide-toggle formControlName="hasEntryTags">Add Registration Tags</mat-slide-toggle>
   </div>

   <div class="form-group" style="text-align: left; padding: 5px;" *ngIf="AboutForm.get('rules').get('hasEntryTags').value == true">
    <app-tag-form [raceID]="raceID" [tagType]="tagType"></app-tag-form>

 </div>

   

   <div style="padding: 5px; position: relative; float: left;">
     <button class="btn btn-primary" mat-raised-button (click)="update()">Update</button>
     <button class="btn btn-danger" mat-raised-button style="left: 5px;" (click)="toggleForm()">Cancel</button>
   </div>

   </div>
 </form>
</div>

 
         
   
 </div>


</div>




<div class="modal fade" id="registerModal">
 <div class="modal-dialog">
   <div class="modal-content">

    
     <div class="modal-header">
       <h4 class="modal-title">Please Register as a Tucan User First</h4>
       <button type="button" class="close" (click)="hideModal('#registerModal')">&times;</button>
     </div>

   
     <div class="modal-body">
       <app-register (registerAlert)="confirmRegistration($event)"></app-register>
     </div>


   </div>
 </div>
</div>
-->



  
