<div class="FeedContainer">

  <!---If we are in race view AND we are authenticated, display form to post new stories-->
  <!-- <div *ngIf="use=='race' && this._authService.isLoggedIn() && this.progress">
    <button (click)="openModal('custom-modal-6')">Make a Post</button>
  </div> -->

  <ng-template [ngIf]='feedItems.length > 0' [ngIfElse]="NothingInFeedBlock">
    <div class='Feed'>
      <div *ngFor="let element of feedItems" class='FeedItem'>
        <div class='FeedProfileImgCell'>
          <div class='FeedProfileImgContainer'>
            <img class="FeedProfileImg" src="{{ element.profile_url }}">
          </div>
        </div>
        <div class='FeedProfileContentCell'>
          <div>
              <ng-template [ngIf]="element.message.length < 20" [ngIfElse]="FeedMessageIsStoryBlock">
                <!-- NO STORY : FITNESS UPDATE -->
                <div class='FeedMessageHeader'>
                  <p class='FeedMessageName'><app-user-profile-nav [username]=element.username [displayName]=element.display_name></app-user-profile-nav></p>
                  <span class='h7'>{{ this.get_created_ts(element.created_ts) }}</span>
                </div>
                <div class='FeedMessageContent'>
                  <p class='margin-bottom-4px'>{{ element.message }}</p>
                </div>
              </ng-template>
              <ng-template #FeedMessageIsStoryBlock>
                <!-- STORY-->
                <div class='FeedMessageHeader'>
                  <p class='FeedMessageName'><app-user-profile-nav [username]=element.username [displayName]=element.display_name></app-user-profile-nav></p>
                  <div class='FeedmessageOtherInfo'>
                    <span class='h7 margin-right-4px'>{{ element.hot? 'ðŸ”¥ðŸ”¥ðŸ”¥' : ' ' }}</span>
                    <span class='h7'>{{ this.get_created_ts(element.created_ts) }}</span>
                  </div>
                </div>
                <div class='FeedMessageContent'>
                  <p class='margin-bottom-4px'>{{ element.story_text }}</p>
                  <img *ngIf="element.story_image" src="{{ element.story_image }}" (click)="showStoryDialog(element)" width="100px" class='margin-bottom-4px'>
                </div>
              </ng-template>
          </div>
          <div class='FeedMessageActionsContainer'>
            <div class='FeedMessageActionsSocialContainer'>
              <app-story-btn class="likeButton" *ngIf="this._authService.isLoggedIn()" [use]="'like'" [storyID]=element.story_id [likes]=element.likes [likesCount]=element.likes_count [likesUsers]=element.likes_users></app-story-btn>
              <div class="commentButton" role="button" (click)="element.show_comments=!element.show_comments"> <i class="material-icons" >comment</i> {{ element.comments.length }}</div>
            </div>
            <div class="dropdown dropdownVisible FeedMessageOptionsDropdown" [ngClass]="{dropdownOpen : element.show_options}" (click)="ToggleStoryOptions(element.story_id)">
              <span class="material-icons">more_horiz</span>
              <div class="dropdownContents FeedMessageOptions">
                <div class='FeedMessageOptionsContent'>
                  <p class='FeedMessageOption' (click)="openReportDialog(element.story_id)">Report Post</p> 
                  <p *ngIf="element.is_mine" class='FeedMessageOption' (click)="openDeleteStoryDialog(element.story_id)">Delete Post</p> 
                </div>
              </div>
            </div>
          </div>
          <ng-template [ngIf]="element.show_comments">
            <app-comments [comments]="element.comments" [storyID]="element.story_id" (commentPosted)="newCommentPosted($event)"></app-comments>
          </ng-template>
        </div>
      </div>
    </div>
<!--
    <table mat-table [dataSource]="feedItems" class="feedTable">
      <ng-container matColumnDef="ProfilePic" >
        <td mat-cell *matCellDef="let element" (click)="clickedOnFeedItem(element)" [hidden]="(followOnly && !element.follows) || (storyOnly && !element.story)">
          <div class='FeedProfileImgContainer'>
            <img class="profileImg" src="{{ element.profile_url }}">
          </div>
        </td>
      </ng-container>
      <ng-container matColumnDef="Data" >
        <td mat-cell *matCellDef="let element" [hidden]="(followOnly && !element.follows) || (storyOnly && !element.story)">
          <div class="row">
            <div class = "main-col">
               <div *ngIf="element.message.length < 20"> 
-->
                 <!-- NO STORY : FITNESS UPDATE -->
<!--
                <b><app-user-profile-nav [username]=element.username [displayName]=element.display_name></app-user-profile-nav></b>
                {{ element.message }}  <small>{{ this.get_created_ts(element.created_ts) }}</small>
              </div>
  
              <div *ngIf="element.message.length >= 20"> 
-->
                <!-- STORY-->
<!--
                 <b><app-user-profile-nav [username]=element.username [displayName]=element.display_name></app-user-profile-nav></b>
                {{ element.story_text }}  {{ element.hot? 'ðŸ”¥ðŸ”¥ðŸ”¥' : ' ' }}  <small>{{ this.get_created_ts(element.created_ts) }}</small>
  
                <div class="container" *ngIf="element.story_image">
                  <img width="100px" src="{{ element.story_image }}" (click)="showStoryDialog(element)">
                </div>
              </div>
  
            </div>
            <div class = "side-col">
               <app-story-btn class="likeButton" *ngIf="this._authService.isLoggedIn()" [use]="'like'" [storyID]=element.story_id [likes]=element.likes [likesCount]=element.likes_count [likesUsers]=element.likes_users></app-story-btn>
  
               <div class="commentButton" role="button" (click)="element.show_comments=!element.show_comments"> <i class="material-icons" >comment</i> {{ element.comments.length }}</div>
  
               <div class="nav-item dropdown">
  
                  <a class="nav-link dropdown-toggle" style="font-size:8px;" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      <i class="material-icons">more_horiz</i>
                  </a>
  
                  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
  
                    <div role="button" (click)="openReportDialog(element.story_id)"> 
                      <p>Report Post</p> 
                    </div>
  
                    <div *ngIf="element.is_mine">
                      <div class="dropdown-divider"></div>
  
                      <div role="button" (click)="openDeleteStoryDialog(element.story_id)">
                        <p>Delete Post</p> 
                      </div>
  
                    </div>
  
                  </div>
                </div>
  
            </div>
          </div>
-->
          <!-- KATIE THIS IS FOR YOUUUUUU :) -->
<!--
          <div *ngIf="element.show_comments">
            <app-comments [comments]="element.comments" [storyID]="element.story_id" (commentPosted)="newCommentPosted($event)"></app-comments>
          </div>
        </td>
      </ng-container>
      <tr mat-row *matRowDef="let myRowData; columns: columns"></tr>
    </table>
-->
  </ng-template>
  <ng-template #NothingInFeedBlock>
    <p>Nothing yet!</p>
  </ng-template>

  <img *ngIf="loading" class="pl-3" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==" />
  <div *ngIf="canRefresh"class="refreshSection">
    <button paginate-button mat-button (click)="refreshFeed(null, true)">Load more...</button>
  </div>
</div>


